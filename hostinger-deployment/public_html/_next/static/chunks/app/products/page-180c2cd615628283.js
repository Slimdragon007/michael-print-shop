(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[571],{8830:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>_});var r=a(5155),s=a(2115),i=a(5695),c=a(6932),l=a(136),n=a(4416),o=a(7168),d=a(9852),u=a(8145),m=a(8482);let g=[{value:"metal",label:"Metal Print"},{value:"canvas",label:"Canvas Print"},{value:"fine-art-paper",label:"Fine Art Paper"}],p=[{label:"Under $50",min:0,max:50},{label:"$50 - $100",min:50,max:100},{label:"$100 - $200",min:100,max:200},{label:"$200 - $500",min:200,max:500},{label:"$500+",min:500,max:999999}];function h(e){var t,a,i,l,h,x;let{filters:f,onFiltersChange:y,categories:v,onClose:_}=e,[j,b]=(0,s.useState)(f.search||""),[N,w]=(0,s.useState)({min:(null==(a=f.price_range)||null==(t=a.min)?void 0:t.toString())||"",max:(null==(l=f.price_range)||null==(i=l.max)?void 0:i.toString())||""}),C=(e,t)=>{y({...f,[e]:t})},P=!!(f.search||f.category||f.material||f.price_range||f.tags&&f.tags.length>0);return(0,r.jsxs)(m.Zp,{className:"w-full",children:[(0,r.jsxs)(m.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[(0,r.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(c.A,{className:"h-5 w-5"}),"Filters"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[P&&(0,r.jsx)(o.$,{variant:"ghost",size:"sm",onClick:()=>{y({}),b(""),w({min:"",max:""})},children:"Clear All"}),_&&(0,r.jsx)(o.$,{variant:"ghost",size:"sm",onClick:_,children:(0,r.jsx)(n.A,{className:"h-4 w-4"})})]})]}),(0,r.jsxs)(m.Wu,{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Search"}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),C("search",j)},className:"flex gap-2",children:[(0,r.jsx)(d.p,{placeholder:"Search products...",value:j,onChange:e=>b(e.target.value)}),(0,r.jsx)(o.$,{type:"submit",size:"sm",children:"Search"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Category"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o.$,{variant:f.category?"outline":"default",size:"sm",className:"w-full justify-start",onClick:()=>C("category",void 0),children:"All Categories"}),v.map(e=>(0,r.jsx)(o.$,{variant:f.category===e.id?"default":"outline",size:"sm",className:"w-full justify-start",onClick:()=>C("category",f.category===e.id?void 0:e.id),children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Material"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o.$,{variant:f.material?"outline":"default",size:"sm",className:"w-full justify-start",onClick:()=>C("material",void 0),children:"All Materials"}),g.map(e=>(0,r.jsx)(o.$,{variant:f.material===e.value?"default":"outline",size:"sm",className:"w-full justify-start",onClick:()=>C("material",f.material===e.value?void 0:e.value),children:e.label},e.value))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Price Range"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o.$,{variant:f.price_range?"outline":"default",size:"sm",className:"w-full justify-start",onClick:()=>C("price_range",void 0),children:"Any Price"}),p.map(e=>{var t,a;let s=(null==(t=f.price_range)?void 0:t.min)===e.min&&(null==(a=f.price_range)?void 0:a.max)===e.max;return(0,r.jsx)(o.$,{variant:s?"default":"outline",size:"sm",className:"w-full justify-start",onClick:()=>{var t,a;C("price_range",{min:t=e.min,max:a=e.max}),w({min:t.toString(),max:a.toString()})},children:e.label},e.label)})]}),(0,r.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,r.jsx)("label",{className:"text-xs text-muted-foreground",children:"Custom Range"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(d.p,{placeholder:"Min",type:"number",value:N.min,onChange:e=>w(t=>({...t,min:e.target.value}))}),(0,r.jsx)(d.p,{placeholder:"Max",type:"number",value:N.max,onChange:e=>w(t=>({...t,max:e.target.value}))})]}),(0,r.jsx)(o.$,{size:"sm",variant:"outline",className:"w-full",onClick:()=>{C("price_range",{min:parseFloat(N.min)||0,max:parseFloat(N.max)||999999})},children:"Apply"})]})]}),P&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Active Filters"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[f.search&&(0,r.jsxs)(u.E,{variant:"secondary",className:"flex items-center gap-1",children:["Search: ",f.search,(0,r.jsx)(n.A,{className:"h-3 w-3 cursor-pointer",onClick:()=>C("search",void 0)})]}),f.category&&(0,r.jsxs)(u.E,{variant:"secondary",className:"flex items-center gap-1",children:[null==(h=v.find(e=>e.id===f.category))?void 0:h.name,(0,r.jsx)(n.A,{className:"h-3 w-3 cursor-pointer",onClick:()=>C("category",void 0)})]}),f.material&&(0,r.jsxs)(u.E,{variant:"secondary",className:"flex items-center gap-1",children:[null==(x=g.find(e=>e.value===f.material))?void 0:x.label,(0,r.jsx)(n.A,{className:"h-3 w-3 cursor-pointer",onClick:()=>C("material",void 0)})]}),f.price_range&&(0,r.jsxs)(u.E,{variant:"secondary",className:"flex items-center gap-1",children:["$",f.price_range.min," - $",f.price_range.max,(0,r.jsx)(n.A,{className:"h-3 w-3 cursor-pointer",onClick:()=>C("price_range",void 0)})]})]})]})]})]})}var x=a(6414);class f{async getProducts(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12;try{let r=this.supabase.from("products").select("\n          *,\n          category:categories(*),\n          print_options(*)\n        ").eq("active",!0);(null==e?void 0:e.category)&&(r=r.eq("category_id",e.category)),(null==e?void 0:e.search)&&(r=r.textSearch("title,description,tags",e.search)),(null==e?void 0:e.tags)&&e.tags.length>0&&(r=r.overlaps("tags",e.tags)),(null==e?void 0:e.price_range)&&(r=r.gte("base_price",e.price_range.min).lte("base_price",e.price_range.max));let s=(t-1)*a,{data:i,error:c,count:l}=await r.range(s,s+a-1).order("created_at",{ascending:!1});if(c)throw c;return{data:(null==i?void 0:i.map(this.transformProductData))||[],pagination:{page:t,per_page:a,total:l||0,total_pages:Math.ceil((l||0)/a)}}}catch(e){throw console.error("Error fetching products:",e),Error("Failed to fetch products")}}async getProductById(e){try{let{data:t,error:a}=await this.supabase.from("products").select("\n          *,\n          category:categories(*),\n          print_options(*)\n        ").eq("id",e).eq("active",!0).single();if(a||!t)return null;return this.transformProductData(t)}catch(e){return console.error("Error fetching product:",e),null}}async getProductBySlug(e){try{let{data:t,error:a}=await this.supabase.from("products").select("\n          *,\n          category:categories(*),\n          print_options(*)\n        ").eq("slug",e).eq("active",!0).single();if(a||!t)return null;return this.transformProductData(t)}catch(e){return console.error("Error fetching product by slug:",e),null}}async createProduct(e){try{let{data:t,error:a}=await this.supabase.from("products").insert({title:e.title,description:e.description,image_url:e.image_url,base_price:e.base_price,category_id:e.category.id,tags:e.tags,dimensions:e.dimensions}).select("\n          *,\n          category:categories(*),\n          print_options(*)\n        ").single();if(a)throw a;let r=this.transformProductData(t);return{success:!0,data:r,message:"Product created successfully"}}catch(e){return console.error("Error creating product:",e),{success:!1,error:"Failed to create product"}}}async updateProduct(e,t){try{let a={};t.title&&(a.title=t.title),t.description&&(a.description=t.description),t.image_url&&(a.image_url=t.image_url),t.base_price&&(a.base_price=t.base_price),t.category&&(a.category_id=t.category.id),t.tags&&(a.tags=t.tags),t.dimensions&&(a.dimensions=t.dimensions),void 0!==t.is_active&&(a.is_active=t.is_active);let{data:r,error:s}=await this.supabase.from("products").update(a).eq("id",e).select("\n          *,\n          category:categories(*),\n          print_options(*)\n        ").single();if(s)throw s;let i=this.transformProductData(r);return{success:!0,data:i,message:"Product updated successfully"}}catch(e){return console.error("Error updating product:",e),{success:!1,error:"Failed to update product"}}}async deleteProduct(e){try{let{error:t}=await this.supabase.from("products").update({is_active:!1}).eq("id",e);if(t)throw t;return{success:!0,message:"Product deleted successfully"}}catch(e){return console.error("Error deleting product:",e),{success:!1,error:"Failed to delete product"}}}async searchProducts(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{let{data:a,error:r}=await this.supabase.from("products").select("\n          *,\n          category:categories(*),\n          print_options(*)\n        ").textSearch("title,description,tags",e).eq("active",!0).limit(t);if(r)throw r;return(null==a?void 0:a.map(this.transformProductData))||[]}catch(e){return console.error("Error searching products:",e),[]}}async getRelatedProducts(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;try{let{data:r,error:s}=await this.supabase.from("products").select("\n          *,\n          category:categories(*),\n          print_options(*)\n        ").eq("category_id",t).neq("id",e).eq("active",!0).limit(a);if(s)throw s;return(null==r?void 0:r.map(this.transformProductData))||[]}catch(e){return console.error("Error fetching related products:",e),[]}}async getFeaturedProducts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;try{let{data:t,error:a}=await this.supabase.from("products").select("\n          *,\n          category:categories(*),\n          print_options(*)\n        ").eq("active",!0).order("created_at",{ascending:!1}).limit(e);if(a)throw a;return(null==t?void 0:t.map(this.transformProductData))||[]}catch(e){return console.error("Error fetching featured products:",e),[]}}transformProductData(e){return{id:e.id,title:e.title,description:e.description,image_url:e.image_url,base_price:e.base_price,category:e.category,tags:e.tags||[],dimensions:e.dimensions,print_options:e.print_options||[],created_at:e.created_at,updated_at:e.updated_at,is_active:e.is_active}}constructor(){this.supabase=x.N,this.supabase=x.N}}class y{async getCategories(){try{let{data:e,error:t}=await this.supabase.from("categories").select("*").order("name");if(t)throw t;return e||[]}catch(e){return console.error("Error fetching categories:",e),[]}}async getCategoryBySlug(e){try{let{data:t,error:a}=await this.supabase.from("categories").select("*").eq("slug",e).single();if(a||!t)return null;return t}catch(e){return console.error("Error fetching category:",e),null}}async createCategory(e){try{let{data:t,error:a}=await this.supabase.from("categories").insert(e).select().single();if(a)throw a;return{success:!0,data:t,message:"Category created successfully"}}catch(e){return console.error("Error creating category:",e),{success:!1,error:"Failed to create category"}}}async updateCategory(e,t){try{let{data:a,error:r}=await this.supabase.from("categories").update(t).eq("id",e).select().single();if(r)throw r;return{success:!0,data:a,message:"Category updated successfully"}}catch(e){return console.error("Error updating category:",e),{success:!1,error:"Failed to update category"}}}constructor(){this.supabase=x.N,this.supabase=x.N}}function v(){let[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)([]),[d,u]=(0,s.useState)({}),[m,g]=(0,s.useState)(!0),[p,x]=(0,s.useState)(!1),v=(0,i.useSearchParams)(),_=new f,j=new y;return(0,s.useEffect)(()=>{(async()=>{n(await j.getCategories())})()},[]),(0,s.useEffect)(()=>{let e={},t=v.get("search");t&&(e.search=t);let a=v.get("category");a&&(e.category=a);let r=v.get("material");r&&(e.material=r);let s=v.get("min_price"),i=v.get("max_price");(s||i)&&(e.price_range={min:s?parseFloat(s):0,max:i?parseFloat(i):999999}),u(e)},[v]),(0,s.useEffect)(()=>{(async()=>{g(!0);try{let e=await _.getProducts(d);t(e.data)}catch(e){console.error("Error loading products:",e)}finally{g(!1)}})()},[d]),(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"All Products"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Discover our complete collection of professional photo prints"})]}),(0,r.jsxs)(o.$,{variant:"outline",onClick:()=>x(!p),className:"lg:hidden",children:[(0,r.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Filters"]})]}),(0,r.jsxs)("div",{className:"grid lg:grid-cols-4 gap-8",children:[(0,r.jsx)("div",{className:"lg:block ".concat(p?"block":"hidden"),children:(0,r.jsx)("div",{className:"sticky top-24",children:(0,r.jsx)(h,{filters:d,onFiltersChange:e=>{u(e);let t=new URLSearchParams;e.search&&t.set("search",e.search),e.category&&t.set("category",e.category),e.material&&t.set("material",e.material),e.price_range&&(e.price_range.min>0&&t.set("min_price",e.price_range.min.toString()),e.price_range.max<999999&&t.set("max_price",e.price_range.max.toString()));let a="".concat(window.location.pathname).concat(t.toString()?"?"+t.toString():"");window.history.replaceState({},"",a)},categories:a,onClose:()=>x(!1)})})}),(0,r.jsxs)("div",{className:"lg:col-span-3",children:[(0,r.jsx)("div",{className:"mb-6 flex items-center justify-between",children:(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:m?"Loading...":"".concat(e.length," products found")})}),(0,r.jsx)(l.ProductGrid,{products:e,loading:m,emptyMessage:"No products match your filters",showWishlist:!0})]})]})]})}function _(){return(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsx)("div",{className:"text-center",children:"Loading products..."})}),children:(0,r.jsx)(v,{})})}},8949:(e,t,a)=>{Promise.resolve().then(a.bind(a,8830))}},e=>{e.O(0,[121,76,358],()=>e(e.s=8949)),_N_E=e.O()}]);